# 32-bit KDE desktop

plugin_prebuild ()
{
cat <<'EOF' >> /mnt/gentoo/var/lib/portage/world
app-portage/eix
app-portage/cfg-update
kde-base/kde-meta
net-misc/x2goserver
EOF

cat <<'EOF' >> /mnt/gentoo/etc/portage/make.conf
USE="$USE X minizip python"
EOF


mkdir /mnt/gentoo/etc/portage
cat <<'EOF' >> /mnt/gentoo/etc/portage/package.keywords
net-misc/x2goserver
EOF

cat <<'EOF' >> /mnt/gentoo/etc/portage/package.unmask
EOF

rm /mnt/gentoo/etc/portage/make.profile
ln -s /usr/portage/profiles/default/linux/x86/13.0/desktop/kde /mnt/gentoo/etc/portage/make.profile

#Fix for EAPI5

mount -t proc none /mnt/gentoo/proc
mount --rbind /dev /mnt/gentoo/dev
mount --rbind /dev/pts /mnt/gentoo/dev/pts

chroot /mnt/gentoo /usr/sbin/env-update
chroot /mnt/gentoo /usr/bin/emerge-webrsync
chroot /mnt/gentoo /usr/bin/emerge sys-apps/portage

umount /mnt/gentoo/proc
umount -l /mnt/gentoo/dev/pts
umount -l /mnt/gentoo/dev

}

plugin_postbuild ()
{
chroot /mnt/gentoo /usr/bin/eix-update
chroot /mnt/gentoo /usr/sbin/x2godbadmin --createdb
}
